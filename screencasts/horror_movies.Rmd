```{r}
library(tidyverse)
library(lubridate)
library(scales)

theme_set(theme_light())
```

```{r}
# 7:20 change to raw 
movie_profit_raw <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2018/2018-10-23/movie_profit.csv")

movie_profit <- movie_profit_raw %>%   
    select(-"...1") %>% 
    dplyr::filter(release_date < "2018-01-01") %>% 
    mutate(release_date = as.Date(parse_date_time(release_date, "%m!/%d/%Y")),
           # six most common distributors and other
           distributor = fct_lump(distributor, n = 6)) %>% 
    # reversing order of rows
    arrange(desc(row_number())) %>% 
    distinct(movie, release_date, .keep_all = TRUE)
    
```

```{r}
movie_profit %>% 
    ggplot(aes(production_budget)) +
    geom_histogram() +
    scale_x_continuous(labels = dollar_format())
    
# less observations comapered to the video
movie_profit %>% 
    ggplot(aes(production_budget)) +
    geom_histogram() +
    scale_x_log10(labels = dollar_format())

# 17:00 production budget based on distributor
movie_profit %>% 
    ggplot(aes(distributor, production_budget)) +
    geom_boxplot() +
    scale_y_log10(labels = dollar_format()) +
    coord_flip()

```
