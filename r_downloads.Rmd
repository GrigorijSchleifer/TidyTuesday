---
title: "R_downloads"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(lubridate)
library(tidytuesdayR)
library(countrycode)
library(scales)
theme_set(theme_light())

# https://thebioengineer.github.io/tidytuesdayR/
r_downloads_year <- tt_load(2018, week=31)
r_downloads_year <- r_downloads_year$r_downloads_year

r_downloads_year <- r_downloads_year %>% 
    select(-X1)
```

```{r}
# counting downloads over time
r_downloads_year %>% 
    count(week = floor_date(date, "week")) %>% 
    # droping incomplete weeks
    dplyr::filter(week > min(week)) %>% 
    ggplot(aes(week, n)) +
    geom_line() +
    expand_limits(y = 0) +
    labs(x = "# of R downloads per week")
```

```{r}
library(lubridate)

r_downloads_year %>% 
    count(date) %>% 
    # label = TRUE will assign the weekdays instead of integers
    group_by(weekday = wday(date, label = TRUE)) %>% 
    summarise(average = mean(n)) %>% 
    ggplot(aes(weekday, average)) +
    # group will connect the dots
    geom_line(group = 1) +
    expand_limits(y = 0)
```

```{r}
r_downloads_year %>% 
    count(country = countrycode(country, "iso2c", "country.name"), sort = TRUE) %>% 
    mutate(percent = n/sum(n)) %>% 
    mutate(country = fct_reorder(country, percent)) %>% 
    dplyr::filter(!is.na(country)) %>% 
    head(13) %>% 
    ggplot(aes(country, percent)) +
    geom_col() +
    coord_flip() +
    scale_y_continuous(labels = percent_format()) +
    labs(title = "What countries install most R?")
```



